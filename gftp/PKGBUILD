# Maintainer: Frank Vanderham <twelve dot eighty at gmail dot com>
# Contributor: Lucien Immink <l.immink@student.fnt.hvu.nl>

pkgname=gftp
pkgver=2.9.1b
pkgrel=6
pkgdesc="A multithreaded ftp client for X Windows"
arch=(powerpc powerpc64 powerpc64le espresso)
url="https://www.gftp.org/"
license=('MIT')
depends=('gtk2' 'openssl' 'readline')
makedepends=('intltool')
source=("gftp-$pkgver.tgz::https://github.com/masneyb/gftp/archive/refs/tags/$pkgver.tar.gz"
        "gtk-too-many-arguments.patch")
sha256sums=('fb134d5479a6b81251b9d37be7264fb8be6edb07bce98569e0e0ba9570587fd6'
            '3435cbb8bba399b3a4b4f9a44215d66b6844a9943b250a7649cc3180f7eb3d58')

prepare() {
   cd "$pkgname-$pkgver"
   # openssl 1.1 compatibility
   #sed -e 's|SSL_library_init|SSL_CTX_new|g' -i configure
}

build() {
   CFLAGS+=' -Wno-error=incompatible-pointer-types' 
   patch -p2 < "${srcdir}"/gtk-too-many-arguments.patch 
   cd "$srcdir/$pkgname-$pkgver"
   autopoint
   ./autogen.sh
   ./configure --prefix=/usr --mandir=/usr/share/man #--enable-gtk3
   make
}

package() {
   cd "$srcdir/$pkgname-$pkgver"
   make DESTDIR="$pkgdir" install
   install -vDm 644 "LICENSE" -t "${pkgdir}/usr/share/licenses/${pkgname}/"
}

