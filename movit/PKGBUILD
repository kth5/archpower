# Maintainer: Jaroslav Lichtblau <svetlemodry@archlinux.org>
# Contributor: Evert Vorster <evorster@gmail.com>
# Contributor: Martin Sandsmark <martin.sandsmark@kde.org>

pkgname=movit
pkgver=1.7.0
pkgrel=1
pkgdesc="The modern video toolkit"
arch=(x86_64 powerpc64le powerpc64 powerpc riscv64)
url="https://movit.sesse.net/"
license=('GPL')
depends=('fftw' 'libepoxy')
makedepends=('eigen' 'gtest' 'sdl2')
source=(https://movit.sesse.net/$pkgname-$pkgver.tar.gz)
sha256sums=('23597b93ea53762d44df763ecc2b702308f76fc17382099e9385220081ce6610')

build() {
  cd $pkgname-$pkgver

  case "${CARCH}" in
    powerpc64)
      export CFLAGS='-O2 -pipe'
      export CXXFLAGS='-O2 -pipe'
    ;;
  esac

  ./configure --prefix=/usr
  make GTEST_DIR=/usr/src/googletest -j1
}

package() {
  cd $pkgname-$pkgver

  make DESTDIR="$pkgdir" install
}
